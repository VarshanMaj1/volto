{"ast":null,"code":"var _jsxFileName = \"/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/Multilingual/CreateTranslation.jsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { changeLanguage } from '@plone/volto/actions/language/language';\nimport { getTranslationLocator } from '@plone/volto/actions/translations/translations';\nimport { getContent } from '@plone/volto/actions/content/content';\nimport { flattenToAppURL } from '@plone/volto/helpers/Url/Url';\nimport { toGettextLang } from '@plone/volto/helpers/Utils/Utils';\nimport config from '@plone/volto/registry';\nconst CreateTranslation = props => {\n  const dispatch = useDispatch();\n  const {\n    language,\n    translationOf\n  } = props.location.state;\n  const [translationLocation, setTranslationLocation] = React.useState(null);\n  const [translationObject, setTranslationObject] = React.useState(null);\n  const languageFrom = useSelector(state => state.intl.locale);\n  React.useEffect(() => {\n    // Only on mount, we dispatch the locator query\n    dispatch(getTranslationLocator(translationOf, language)).then(resp => {\n      setTranslationLocation(resp['@id']);\n    });\n\n    //and we load the translationObject\n    dispatch(getContent(translationOf, null, 'translationObject')).then(resp => {\n      setTranslationObject(resp);\n    });\n\n    // On unmount we dispatch the language change\n    return () => {\n      // We change the interface language\n      if (config.settings.supportedLanguages.includes(language)) {\n        const langFileName = toGettextLang(language);\n        import(/* @vite-ignore */'@root/../locales/' + langFileName + '.json').then(locale => {\n          dispatch(changeLanguage(language, locale.default));\n        });\n      }\n    };\n    // On mount only\n    /* eslint-disable react-hooks/exhaustive-deps */\n  }, []);\n  return translationLocation && translationObject && __jsx(Redirect, {\n    to: {\n      pathname: `${flattenToAppURL(translationLocation)}/add`,\n      search: `?type=${props.location.state.type}`,\n      state: {\n        translationOf: props.location.state.translationOf,\n        language: props.location.state.language,\n        translationObject: translationObject,\n        languageFrom\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  });\n};\nexport default CreateTranslation;","map":{"version":3,"names":["React","Redirect","useDispatch","useSelector","changeLanguage","getTranslationLocator","getContent","flattenToAppURL","toGettextLang","config","CreateTranslation","props","dispatch","language","translationOf","location","state","translationLocation","setTranslationLocation","useState","translationObject","setTranslationObject","languageFrom","intl","locale","useEffect","then","resp","settings","supportedLanguages","includes","langFileName","default","__jsx","to","pathname","search","type","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/Multilingual/CreateTranslation.jsx"],"sourcesContent":["import React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { changeLanguage } from '@plone/volto/actions/language/language';\nimport { getTranslationLocator } from '@plone/volto/actions/translations/translations';\nimport { getContent } from '@plone/volto/actions/content/content';\nimport { flattenToAppURL } from '@plone/volto/helpers/Url/Url';\nimport { toGettextLang } from '@plone/volto/helpers/Utils/Utils';\nimport config from '@plone/volto/registry';\n\nconst CreateTranslation = (props) => {\n  const dispatch = useDispatch();\n  const { language, translationOf } = props.location.state;\n  const [translationLocation, setTranslationLocation] = React.useState(null);\n  const [translationObject, setTranslationObject] = React.useState(null);\n  const languageFrom = useSelector((state) => state.intl.locale);\n\n  React.useEffect(() => {\n    // Only on mount, we dispatch the locator query\n    dispatch(getTranslationLocator(translationOf, language)).then((resp) => {\n      setTranslationLocation(resp['@id']);\n    });\n\n    //and we load the translationObject\n    dispatch(getContent(translationOf, null, 'translationObject')).then(\n      (resp) => {\n        setTranslationObject(resp);\n      },\n    );\n\n    // On unmount we dispatch the language change\n    return () => {\n      // We change the interface language\n      if (config.settings.supportedLanguages.includes(language)) {\n        const langFileName = toGettextLang(language);\n        import(\n          /* @vite-ignore */ '@root/../locales/' + langFileName + '.json'\n        ).then((locale) => {\n          dispatch(changeLanguage(language, locale.default));\n        });\n      }\n    };\n    // On mount only\n    /* eslint-disable react-hooks/exhaustive-deps */\n  }, []);\n\n  return (\n    translationLocation &&\n    translationObject && (\n      <Redirect\n        to={{\n          pathname: `${flattenToAppURL(translationLocation)}/add`,\n          search: `?type=${props.location.state.type}`,\n          state: {\n            translationOf: props.location.state.translationOf,\n            language: props.location.state.language,\n            translationObject: translationObject,\n            languageFrom,\n          },\n        }}\n      />\n    )\n  );\n};\n\nexport default CreateTranslation;\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAASC,cAAc,QAAQ,wCAAwC;AACvE,SAASC,qBAAqB,QAAQ,gDAAgD;AACtF,SAASC,UAAU,QAAQ,sCAAsC;AACjE,SAASC,eAAe,QAAQ,8BAA8B;AAC9D,SAASC,aAAa,QAAQ,kCAAkC;AAChE,OAAOC,MAAM,MAAM,uBAAuB;AAE1C,MAAMC,iBAAiB,GAAIC,KAAK,IAAK;EACnC,MAAMC,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEW,QAAQ;IAAEC;EAAc,CAAC,GAAGH,KAAK,CAACI,QAAQ,CAACC,KAAK;EACxD,MAAM,CAACC,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGlB,KAAK,CAACmB,QAAQ,CAAC,IAAI,CAAC;EAC1E,MAAM,CAACC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGrB,KAAK,CAACmB,QAAQ,CAAC,IAAI,CAAC;EACtE,MAAMG,YAAY,GAAGnB,WAAW,CAAEa,KAAK,IAAKA,KAAK,CAACO,IAAI,CAACC,MAAM,CAAC;EAE9DxB,KAAK,CAACyB,SAAS,CAAC,MAAM;IACpB;IACAb,QAAQ,CAACP,qBAAqB,CAACS,aAAa,EAAED,QAAQ,CAAC,CAAC,CAACa,IAAI,CAAEC,IAAI,IAAK;MACtET,sBAAsB,CAACS,IAAI,CAAC,KAAK,CAAC,CAAC;IACrC,CAAC,CAAC;;IAEF;IACAf,QAAQ,CAACN,UAAU,CAACQ,aAAa,EAAE,IAAI,EAAE,mBAAmB,CAAC,CAAC,CAACY,IAAI,CAChEC,IAAI,IAAK;MACRN,oBAAoB,CAACM,IAAI,CAAC;IAC5B,CACF,CAAC;;IAED;IACA,OAAO,MAAM;MACX;MACA,IAAIlB,MAAM,CAACmB,QAAQ,CAACC,kBAAkB,CAACC,QAAQ,CAACjB,QAAQ,CAAC,EAAE;QACzD,MAAMkB,YAAY,GAAGvB,aAAa,CAACK,QAAQ,CAAC;QAC5C,MAAM,CACJ,kBAAmB,mBAAmB,GAAGkB,YAAY,GAAG,OAC1D,CAAC,CAACL,IAAI,CAAEF,MAAM,IAAK;UACjBZ,QAAQ,CAACR,cAAc,CAACS,QAAQ,EAAEW,MAAM,CAACQ,OAAO,CAAC,CAAC;QACpD,CAAC,CAAC;MACJ;IACF,CAAC;IACD;IACA;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,OACEf,mBAAmB,IACnBG,iBAAiB,IACfa,KAAA,CAAChC,QAAQ;IACPiC,EAAE,EAAE;MACFC,QAAQ,EAAE,GAAG5B,eAAe,CAACU,mBAAmB,CAAC,MAAM;MACvDmB,MAAM,EAAE,SAASzB,KAAK,CAACI,QAAQ,CAACC,KAAK,CAACqB,IAAI,EAAE;MAC5CrB,KAAK,EAAE;QACLF,aAAa,EAAEH,KAAK,CAACI,QAAQ,CAACC,KAAK,CAACF,aAAa;QACjDD,QAAQ,EAAEF,KAAK,CAACI,QAAQ,CAACC,KAAK,CAACH,QAAQ;QACvCO,iBAAiB,EAAEA,iBAAiB;QACpCE;MACF;IACF,CAAE;IAAAgB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CACH,CACF;AAEL,CAAC;AAED,eAAejC,iBAAiB","ignoreList":[]},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}