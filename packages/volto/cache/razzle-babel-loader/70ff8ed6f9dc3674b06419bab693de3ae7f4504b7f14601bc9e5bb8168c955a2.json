{"ast":null,"code":"function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { GET_QUERYSTRING_RESULTS } from '@plone/volto/constants/ActionTypes';\nimport config from '@plone/volto/registry';\n\n/**\n * Get querystring results.\n * @function getQueryStringResults\n * @param {Object} data Data.\n * @returns {Object} Get querystringsearch results action.\n */\nexport function getQueryStringResults(path, data, subrequest, page) {\n  const {\n    settings\n  } = config;\n\n  // fixes https://github.com/plone/volto/issues/1059\n  let requestData = JSON.parse(JSON.stringify(data));\n  if ((data === null || data === void 0 ? void 0 : data.depth) != null) {\n    delete requestData.depth;\n    requestData.query.forEach(q => {\n      if (q.i === 'path') {\n        q.v += '::' + data.depth;\n      }\n    });\n  }\n\n  // fixes https://github.com/plone/volto/issues/2397\n  if ((requestData === null || requestData === void 0 ? void 0 : requestData.sort_order) !== null) {\n    if (typeof requestData.sort_order === 'boolean') {\n      requestData.sort_order = requestData.sort_order ? 'descending' : 'ascending';\n    }\n  }\n  const query = _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, requestData), !requestData.b_size && {\n    b_size: settings.defaultPageSize\n  }), page && {\n    b_start: requestData.b_size ? data.b_size * (page - 1) : settings.defaultPageSize * (page - 1)\n  }), {}, {\n    query: requestData === null || requestData === void 0 ? void 0 : requestData.query\n  });\n  return {\n    type: GET_QUERYSTRING_RESULTS,\n    subrequest,\n    request: {\n      op: settings.querystringSearchGet ? 'get' : 'post',\n      path: `${path}/@querystring-search${settings.querystringSearchGet ? `?query=${encodeURIComponent(JSON.stringify(query))}` : ''}`,\n      data: settings.querystringSearchGet ? null : query\n    }\n  };\n}","map":{"version":3,"names":["GET_QUERYSTRING_RESULTS","config","getQueryStringResults","path","data","subrequest","page","settings","requestData","JSON","parse","stringify","depth","query","forEach","q","i","v","sort_order","_objectSpread","b_size","defaultPageSize","b_start","type","request","op","querystringSearchGet","encodeURIComponent"],"sources":["/Users/varshanmaji/Projects/volto/packages/volto/src/actions/querystringsearch/querystringsearch.js"],"sourcesContent":["import { GET_QUERYSTRING_RESULTS } from '@plone/volto/constants/ActionTypes';\nimport config from '@plone/volto/registry';\n\n/**\n * Get querystring results.\n * @function getQueryStringResults\n * @param {Object} data Data.\n * @returns {Object} Get querystringsearch results action.\n */\nexport function getQueryStringResults(path, data, subrequest, page) {\n  const { settings } = config;\n\n  // fixes https://github.com/plone/volto/issues/1059\n  let requestData = JSON.parse(JSON.stringify(data));\n\n  if (data?.depth != null) {\n    delete requestData.depth;\n    requestData.query.forEach((q) => {\n      if (q.i === 'path') {\n        q.v += '::' + data.depth;\n      }\n    });\n  }\n\n  // fixes https://github.com/plone/volto/issues/2397\n  if (requestData?.sort_order !== null) {\n    if (typeof requestData.sort_order === 'boolean') {\n      requestData.sort_order = requestData.sort_order\n        ? 'descending'\n        : 'ascending';\n    }\n  }\n\n  const query = {\n    ...requestData,\n    ...(!requestData.b_size && {\n      b_size: settings.defaultPageSize,\n    }),\n    ...(page && {\n      b_start: requestData.b_size\n        ? data.b_size * (page - 1)\n        : settings.defaultPageSize * (page - 1),\n    }),\n    query: requestData?.query,\n  };\n\n  return {\n    type: GET_QUERYSTRING_RESULTS,\n    subrequest,\n    request: {\n      op: settings.querystringSearchGet ? 'get' : 'post',\n      path: `${path}/@querystring-search${\n        settings.querystringSearchGet\n          ? `?query=${encodeURIComponent(JSON.stringify(query))}`\n          : ''\n      }`,\n      data: settings.querystringSearchGet ? null : query,\n    },\n  };\n}\n"],"mappings":";;;;;AAAA,SAASA,uBAAuB,QAAQ,oCAAoC;AAC5E,OAAOC,MAAM,MAAM,uBAAuB;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,qBAAqBA,CAACC,IAAI,EAAEC,IAAI,EAAEC,UAAU,EAAEC,IAAI,EAAE;EAClE,MAAM;IAAEC;EAAS,CAAC,GAAGN,MAAM;;EAE3B;EACA,IAAIO,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,IAAI,CAAC,CAAC;EAElD,IAAI,CAAAA,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEQ,KAAK,KAAI,IAAI,EAAE;IACvB,OAAOJ,WAAW,CAACI,KAAK;IACxBJ,WAAW,CAACK,KAAK,CAACC,OAAO,CAAEC,CAAC,IAAK;MAC/B,IAAIA,CAAC,CAACC,CAAC,KAAK,MAAM,EAAE;QAClBD,CAAC,CAACE,CAAC,IAAI,IAAI,GAAGb,IAAI,CAACQ,KAAK;MAC1B;IACF,CAAC,CAAC;EACJ;;EAEA;EACA,IAAI,CAAAJ,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEU,UAAU,MAAK,IAAI,EAAE;IACpC,IAAI,OAAOV,WAAW,CAACU,UAAU,KAAK,SAAS,EAAE;MAC/CV,WAAW,CAACU,UAAU,GAAGV,WAAW,CAACU,UAAU,GAC3C,YAAY,GACZ,WAAW;IACjB;EACF;EAEA,MAAML,KAAK,GAAAM,aAAA,CAAAA,aAAA,CAAAA,aAAA,CAAAA,aAAA,KACNX,WAAW,GACV,CAACA,WAAW,CAACY,MAAM,IAAI;IACzBA,MAAM,EAAEb,QAAQ,CAACc;EACnB,CAAC,GACGf,IAAI,IAAI;IACVgB,OAAO,EAAEd,WAAW,CAACY,MAAM,GACvBhB,IAAI,CAACgB,MAAM,IAAId,IAAI,GAAG,CAAC,CAAC,GACxBC,QAAQ,CAACc,eAAe,IAAIf,IAAI,GAAG,CAAC;EAC1C,CAAC;IACDO,KAAK,EAAEL,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEK;EAAK,EAC1B;EAED,OAAO;IACLU,IAAI,EAAEvB,uBAAuB;IAC7BK,UAAU;IACVmB,OAAO,EAAE;MACPC,EAAE,EAAElB,QAAQ,CAACmB,oBAAoB,GAAG,KAAK,GAAG,MAAM;MAClDvB,IAAI,EAAE,GAAGA,IAAI,uBACXI,QAAQ,CAACmB,oBAAoB,GACzB,UAAUC,kBAAkB,CAAClB,IAAI,CAACE,SAAS,CAACE,KAAK,CAAC,CAAC,EAAE,GACrD,EAAE,EACN;MACFT,IAAI,EAAEG,QAAQ,CAACmB,oBAAoB,GAAG,IAAI,GAAGb;IAC/C;EACF,CAAC;AACH","ignoreList":[]},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}