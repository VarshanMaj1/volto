{"ast":null,"code":"const _excluded = [\"pluggable\", \"id\", \"dependencies\", \"children\"];\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\n\nimport React from 'react';\nimport sortBy from 'lodash/sortBy';\nexport const context = /*#__PURE__*/React.createContext();\nexport function usePluggable(name) {\n  const ctx = React.useContext(context);\n  if (!ctx) {\n    throw new Error('Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>');\n  }\n  return ctx.pluggables[name] || [];\n}\n\n/**\n\n**/\nexport function Pluggable(props) {\n  const {\n    name,\n    maxCount,\n    reversed,\n    children,\n    params\n  } = props; // , ...rest\n  let pluggables = usePluggable(name);\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n  if (params && children) {\n    throw Error('Cannot specify render function and params props at the same time');\n  }\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n    return /*#__PURE__*/React.createElement(React.Fragment, {}, pluggables.map((R, i) => /*#__PURE__*/React.createElement(R, _objectSpread({\n      key: i.toString()\n    }, params))));\n  }, [params, pluggables, children]);\n}\nexport function usePlug({\n  pluggable,\n  id,\n  renderer,\n  dependencies,\n  options\n}) {\n  const pluggableContext = React.useContext(context);\n  if (!pluggableContext) {\n    throw new Error('Using <Plug> component or usePlug hook outside of <PluggablesProvider>');\n  }\n  const {\n    setPlug,\n    removePlug\n  } = pluggableContext;\n  const {\n    name,\n    order,\n    extra\n  } = options;\n\n  // Could be that a Plug is empty (or it evaluates and have no children)\n  if (renderer) {\n    Object.assign(renderer, {\n      pluggableName: name,\n      extra,\n      order\n    });\n  }\n  React.useEffect(() => {\n    if (renderer) {\n      setPlug(pluggable, id, renderer);\n      return () => removePlug(pluggable, id);\n    }\n  }, dependencies // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\nexport const Plug = _ref => {\n  let {\n      pluggable,\n      id,\n      dependencies = [],\n      children\n    } = _ref,\n    options = _objectWithoutProperties(_ref, _excluded);\n  const renderer = children && (typeof children === 'function' ? children : () => children);\n  usePlug({\n    pluggable,\n    id,\n    renderer,\n    dependencies,\n    options\n  });\n  return null;\n};\nexport function createPluggable(name) {\n  const pluggable = props => /*#__PURE__*/React.createElement(Pluggable, _objectSpread({\n    name\n  }, props));\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = props => /*#__PURE__*/React.createElement(Plug, _objectSpread({\n    pluggable: pluggableName\n  }, props));\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n\n/**\n * Creates a Pluggable + Plug pair\n */\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\nexport const PluggablesProvider = ({\n  children\n}) => {\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, {\n      id\n    });\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: sortBy([...(prevState.pluggables[pluggable] || []).filter(e => e.id !== id), renderer], e => e.order || 0)\n      })\n    }));\n  };\n  const removePlug = (pluggable, name) => {\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: sortBy((prevState.pluggables[pluggable] || []).filter(e => e.id !== name), e => e.order || 0)\n      })\n    }));\n  };\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug\n  };\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: pluggables\n  }, children);\n};\nexport default Pluggable;","map":{"version":3,"names":["React","sortBy","context","createContext","usePluggable","name","ctx","useContext","Error","pluggables","Pluggable","props","maxCount","reversed","children","params","undefined","slice","reverse","useMemo","createElement","Fragment","map","R","i","_objectSpread","key","toString","usePlug","pluggable","id","renderer","dependencies","options","pluggableContext","setPlug","removePlug","order","extra","Object","assign","pluggableName","useEffect","Plug","_ref","_objectWithoutProperties","_excluded","createPluggable","createPlugComponent","plugComponent","displayName","createPluggableAndPlug","boundPluggable","PluggablesProvider","setPluggables","prevState","filter","e","initialPluggables","useState","Provider","value"],"sources":["/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/Pluggable/index.js"],"sourcesContent":["// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\n\nimport React from 'react';\nimport sortBy from 'lodash/sortBy';\n\nexport const context = React.createContext();\n\nexport function usePluggable(name) {\n  const ctx = React.useContext(context);\n\n  if (!ctx) {\n    throw new Error(\n      'Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>',\n    );\n  }\n\n  return ctx.pluggables[name] || [];\n}\n\n/**\n\n**/\nexport function Pluggable(props) {\n  const { name, maxCount, reversed, children, params } = props; // , ...rest\n  let pluggables = usePluggable(name);\n\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n\n  if (params && children) {\n    throw Error(\n      'Cannot specify render function and params props at the same time',\n    );\n  }\n\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n\n    return React.createElement(\n      React.Fragment,\n      {},\n      pluggables.map((R, i) =>\n        React.createElement(R, { key: i.toString(), ...params }),\n      ),\n    );\n  }, [params, pluggables, children]);\n}\n\nexport function usePlug({ pluggable, id, renderer, dependencies, options }) {\n  const pluggableContext = React.useContext(context);\n  if (!pluggableContext) {\n    throw new Error(\n      'Using <Plug> component or usePlug hook outside of <PluggablesProvider>',\n    );\n  }\n  const { setPlug, removePlug } = pluggableContext;\n  const { name, order, extra } = options;\n\n  // Could be that a Plug is empty (or it evaluates and have no children)\n  if (renderer) {\n    Object.assign(renderer, { pluggableName: name, extra, order });\n  }\n\n  React.useEffect(\n    () => {\n      if (renderer) {\n        setPlug(pluggable, id, renderer);\n        return () => removePlug(pluggable, id);\n      }\n    },\n    dependencies, // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\n\nexport const Plug = ({\n  pluggable,\n  id,\n  dependencies = [],\n  children,\n  ...options\n}) => {\n  const renderer =\n    children && (typeof children === 'function' ? children : () => children);\n  usePlug({ pluggable, id, renderer, dependencies, options });\n  return null;\n};\n\nexport function createPluggable(name) {\n  const pluggable = (props) =>\n    React.createElement(Pluggable, { name, ...props });\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\n\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = (props) =>\n    React.createElement(Plug, { pluggable: pluggableName, ...props });\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n\n/**\n * Creates a Pluggable + Plug pair\n */\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\n\nexport const PluggablesProvider = ({ children }) => {\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, { id });\n\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          [\n            ...(prevState.pluggables[pluggable] || []).filter(\n              (e) => e.id !== id,\n            ),\n            renderer,\n          ],\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const removePlug = (pluggable, name) => {\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          (prevState.pluggables[pluggable] || []).filter((e) => e.id !== name),\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug,\n  };\n\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return React.createElement(context.Provider, { value: pluggables }, children);\n};\n\nexport default Pluggable;\n"],"mappings":"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","ignoreList":[]},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}