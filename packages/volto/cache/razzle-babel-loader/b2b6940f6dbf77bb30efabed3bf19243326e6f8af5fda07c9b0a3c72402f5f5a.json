{"ast":null,"code":"import _extends from \"/Users/varshanmaji/Projects/volto/node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/extends.js\";\nvar _jsxFileName = \"/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/BlockChooser/BlockChooserButton.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React from 'react';\nimport doesNodeContainClick from 'semantic-ui-react/dist/commonjs/lib/doesNodeContainClick';\nimport addSVG from '@plone/volto/icons/circle-plus.svg';\nimport { blockHasValue } from '@plone/volto/helpers/Blocks/Blocks';\nimport Icon from '@plone/volto/components/theme/Icon/Icon';\nimport BlockChooser from '@plone/volto/components/manage/BlockChooser/BlockChooser';\nimport config from '@plone/volto/registry';\nimport { Button, Ref } from 'semantic-ui-react';\nimport { defineMessages, useIntl } from 'react-intl';\nimport { usePopper } from 'react-popper';\nimport { createPortal } from 'react-dom';\nconst messages = defineMessages({\n  addBlock: {\n    \"id\": \"Add block\",\n    \"defaultMessage\": \"Add block\"\n  }\n});\nexport const ButtonComponent = props => {\n  _s();\n  const intl = useIntl();\n  const {\n    className = `block-add-button${config.experimental.addBlockButton.enabled ? ' new-add-block' : ''}`,\n    size = '19px',\n    onShowBlockChooser\n  } = props;\n  return __jsx(Button, {\n    icon: true,\n    basic: true,\n    title: intl.formatMessage(messages.addBlock),\n    onClick: e => {\n      e.preventDefault();\n      e.stopPropagation();\n      onShowBlockChooser();\n    },\n    className: className,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 5\n    }\n  }, __jsx(Icon, {\n    name: addSVG,\n    className: className,\n    size: size,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }\n  }));\n};\n_s(ButtonComponent, \"rlSgSjbewJ1PrR/Ile8g/kr050o=\", false, function () {\n  return [useIntl];\n});\n_c = ButtonComponent;\nconst BlockChooserButton = props => {\n  _s2();\n  const {\n    block,\n    allowedBlocks,\n    showRestricted,\n    data,\n    onMutateBlock,\n    onInsertBlock,\n    blocksConfig,\n    buttonComponent,\n    properties,\n    navRoot,\n    contentType\n  } = props;\n  const {\n    disableNewBlocks\n  } = data;\n  const [addNewBlockOpened, setAddNewBlockOpened] = React.useState(false);\n  const blockChooserRef = React.useRef();\n  const handleClickOutside = React.useCallback(e => {\n    if (blockChooserRef.current && doesNodeContainClick(blockChooserRef.current, e)) return;\n    setAddNewBlockOpened(false);\n  }, []);\n  const Component = buttonComponent || ButtonComponent;\n  React.useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutside, false);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside, false);\n    };\n  }, [handleClickOutside]);\n  const [referenceElement, setReferenceElement] = React.useState(null);\n  const [popperElement, setPopperElement] = React.useState(null);\n  const {\n    styles,\n    attributes\n  } = usePopper(referenceElement, popperElement, {\n    placement: config.experimental.addBlockButton.enabled ? 'bottom' : 'right-start',\n    modifiers: [{\n      name: 'offset',\n      options: {\n        offset: [-10, 5]\n      }\n    }, {\n      name: 'flip',\n      options: {\n        fallbackPlacements: config.experimental.addBlockButton.enabled ? ['bottom-start', 'bottom-end'] : ['right-end', 'top-start']\n      }\n    }]\n  });\n  return __jsx(React.Fragment, null, !disableNewBlocks && (config.experimental.addBlockButton.enabled || !blockHasValue(data)) && __jsx(Ref, {\n    innerRef: setReferenceElement,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, __jsx(Component, _extends({}, props, {\n    onShowBlockChooser: () => setAddNewBlockOpened(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }))), addNewBlockOpened && /*#__PURE__*/createPortal(__jsx(\"div\", _extends({\n    ref: setPopperElement,\n    style: styles.popper\n  }, attributes.popper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 11\n    }\n  }), __jsx(BlockChooser, {\n    onMutateBlock: onMutateBlock ? (id, value) => {\n      setAddNewBlockOpened(false);\n      onMutateBlock(id, value);\n    } : null,\n    onInsertBlock: onInsertBlock ? (id, value) => {\n      setAddNewBlockOpened(false);\n      onInsertBlock(id, value);\n    } : null,\n    currentBlock: block,\n    allowedBlocks: allowedBlocks,\n    blocksConfig: blocksConfig,\n    properties: properties,\n    showRestricted: showRestricted,\n    ref: blockChooserRef,\n    navRoot: navRoot,\n    contentType: contentType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  })), document.body));\n};\n_s2(BlockChooserButton, \"KkpdY0BiJTtrCAiHdbnfi8e2vIQ=\", false, function () {\n  return [usePopper];\n});\n_c2 = BlockChooserButton;\nexport default BlockChooserButton;\nvar _c, _c2;\n$RefreshReg$(_c, \"ButtonComponent\");\n$RefreshReg$(_c2, \"BlockChooserButton\");","map":{"version":3,"names":["React","doesNodeContainClick","addSVG","blockHasValue","Icon","BlockChooser","config","Button","Ref","defineMessages","useIntl","usePopper","createPortal","messages","addBlock","ButtonComponent","props","_s","intl","className","experimental","addBlockButton","enabled","size","onShowBlockChooser","__jsx","icon","basic","title","formatMessage","onClick","e","preventDefault","stopPropagation","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","name","_c","BlockChooserButton","_s2","block","allowedBlocks","showRestricted","data","onMutateBlock","onInsertBlock","blocksConfig","buttonComponent","properties","navRoot","contentType","disableNewBlocks","addNewBlockOpened","setAddNewBlockOpened","useState","blockChooserRef","useRef","handleClickOutside","useCallback","current","Component","useEffect","document","addEventListener","removeEventListener","referenceElement","setReferenceElement","popperElement","setPopperElement","styles","attributes","placement","modifiers","options","offset","fallbackPlacements","Fragment","innerRef","_extends","ref","style","popper","id","value","currentBlock","body","_c2","$RefreshReg$"],"sources":["/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/BlockChooser/BlockChooserButton.jsx"],"sourcesContent":["import React from 'react';\nimport doesNodeContainClick from 'semantic-ui-react/dist/commonjs/lib/doesNodeContainClick';\nimport addSVG from '@plone/volto/icons/circle-plus.svg';\nimport { blockHasValue } from '@plone/volto/helpers/Blocks/Blocks';\nimport Icon from '@plone/volto/components/theme/Icon/Icon';\nimport BlockChooser from '@plone/volto/components/manage/BlockChooser/BlockChooser';\nimport config from '@plone/volto/registry';\nimport { Button, Ref } from 'semantic-ui-react';\nimport { defineMessages, useIntl } from 'react-intl';\nimport { usePopper } from 'react-popper';\nimport { createPortal } from 'react-dom';\n\nconst messages = defineMessages({\n  addBlock: {\n    id: 'Add block',\n    defaultMessage: 'Add block',\n  },\n});\n\nexport const ButtonComponent = (props) => {\n  const intl = useIntl();\n  const {\n    className = `block-add-button${\n      config.experimental.addBlockButton.enabled ? ' new-add-block' : ''\n    }`,\n    size = '19px',\n    onShowBlockChooser,\n  } = props;\n\n  return (\n    <Button\n      icon\n      basic\n      title={intl.formatMessage(messages.addBlock)}\n      onClick={(e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        onShowBlockChooser();\n      }}\n      className={className}\n    >\n      <Icon name={addSVG} className={className} size={size} />\n    </Button>\n  );\n};\n\nconst BlockChooserButton = (props) => {\n  const {\n    block,\n    allowedBlocks,\n    showRestricted,\n    data,\n    onMutateBlock,\n    onInsertBlock,\n    blocksConfig,\n    buttonComponent,\n    properties,\n    navRoot,\n    contentType,\n  } = props;\n\n  const { disableNewBlocks } = data;\n  const [addNewBlockOpened, setAddNewBlockOpened] = React.useState(false);\n\n  const blockChooserRef = React.useRef();\n\n  const handleClickOutside = React.useCallback((e) => {\n    if (\n      blockChooserRef.current &&\n      doesNodeContainClick(blockChooserRef.current, e)\n    )\n      return;\n    setAddNewBlockOpened(false);\n  }, []);\n\n  const Component = buttonComponent || ButtonComponent;\n\n  React.useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutside, false);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside, false);\n    };\n  }, [handleClickOutside]);\n\n  const [referenceElement, setReferenceElement] = React.useState(null);\n  const [popperElement, setPopperElement] = React.useState(null);\n  const { styles, attributes } = usePopper(referenceElement, popperElement, {\n    placement: config.experimental.addBlockButton.enabled\n      ? 'bottom'\n      : 'right-start',\n    modifiers: [\n      {\n        name: 'offset',\n        options: {\n          offset: [-10, 5],\n        },\n      },\n      {\n        name: 'flip',\n        options: {\n          fallbackPlacements: config.experimental.addBlockButton.enabled\n            ? ['bottom-start', 'bottom-end']\n            : ['right-end', 'top-start'],\n        },\n      },\n    ],\n  });\n\n  return (\n    <>\n      {!disableNewBlocks &&\n        (config.experimental.addBlockButton.enabled ||\n          !blockHasValue(data)) && (\n          <Ref innerRef={setReferenceElement}>\n            <Component\n              {...props}\n              onShowBlockChooser={() => setAddNewBlockOpened(true)}\n            />\n          </Ref>\n        )}\n      {addNewBlockOpened &&\n        createPortal(\n          <div\n            ref={setPopperElement}\n            style={styles.popper}\n            {...attributes.popper}\n          >\n            <BlockChooser\n              onMutateBlock={\n                onMutateBlock\n                  ? (id, value) => {\n                      setAddNewBlockOpened(false);\n                      onMutateBlock(id, value);\n                    }\n                  : null\n              }\n              onInsertBlock={\n                onInsertBlock\n                  ? (id, value) => {\n                      setAddNewBlockOpened(false);\n                      onInsertBlock(id, value);\n                    }\n                  : null\n              }\n              currentBlock={block}\n              allowedBlocks={allowedBlocks}\n              blocksConfig={blocksConfig}\n              properties={properties}\n              showRestricted={showRestricted}\n              ref={blockChooserRef}\n              navRoot={navRoot}\n              contentType={contentType}\n            />\n          </div>,\n          document.body,\n        )}\n    </>\n  );\n};\n\nexport default BlockChooserButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{"react-intl":{"messages":[{"id":"Add block","defaultMessage":"Add block"}]}},"sourceType":"module","externalDependencies":[]}