{"ast":null,"code":"import _objectWithoutProperties from \"/Users/varshanmaji/Projects/volto/node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _objectSpread from \"/Users/varshanmaji/Projects/volto/node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nconst _excluded = [\"pluggable\", \"id\", \"dependencies\", \"children\"];\nvar _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$(),\n  _s5 = $RefreshSig$();\n// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\n\nimport React from 'react';\nimport sortBy from 'lodash/sortBy';\nexport const context = /*#__PURE__*/React.createContext();\nexport function usePluggable(name) {\n  _s();\n  const ctx = React.useContext(context);\n  if (!ctx) {\n    throw new Error('Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>');\n  }\n  return ctx.pluggables[name] || [];\n}\n\n/**\n\n**/\n_s(usePluggable, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nexport function Pluggable(props) {\n  _s2();\n  const {\n    name,\n    maxCount,\n    reversed,\n    children,\n    params\n  } = props; // , ...rest\n  let pluggables = usePluggable(name);\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n  if (params && children) {\n    throw Error('Cannot specify render function and params props at the same time');\n  }\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n    return /*#__PURE__*/React.createElement(React.Fragment, {}, pluggables.map((R, i) => /*#__PURE__*/React.createElement(R, _objectSpread({\n      key: i.toString()\n    }, params))));\n  }, [params, pluggables, children]);\n}\n_s2(Pluggable, \"ZbjoaxxutRQg0EuROCa294WlHbQ=\", false, function () {\n  return [usePluggable];\n});\n_c = Pluggable;\nexport function usePlug({\n  pluggable,\n  id,\n  renderer,\n  dependencies,\n  options\n}) {\n  _s3();\n  const pluggableContext = React.useContext(context);\n  if (!pluggableContext) {\n    throw new Error('Using <Plug> component or usePlug hook outside of <PluggablesProvider>');\n  }\n  const {\n    setPlug,\n    removePlug\n  } = pluggableContext;\n  const {\n    name,\n    order,\n    extra\n  } = options;\n\n  // Could be that a Plug is empty (or it evaluates and have no children)\n  if (renderer) {\n    Object.assign(renderer, {\n      pluggableName: name,\n      extra,\n      order\n    });\n  }\n  React.useEffect(() => {\n    if (renderer) {\n      setPlug(pluggable, id, renderer);\n      return () => removePlug(pluggable, id);\n    }\n  }, dependencies // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\n_s3(usePlug, \"Dhu0SPkT8wm5j61G7Xr6Vu3kyoE=\");\nexport const Plug = _ref => {\n  _s4();\n  let {\n      pluggable,\n      id,\n      dependencies = [],\n      children\n    } = _ref,\n    options = _objectWithoutProperties(_ref, _excluded);\n  const renderer = children && (typeof children === 'function' ? children : () => children);\n  usePlug({\n    pluggable,\n    id,\n    renderer,\n    dependencies,\n    options\n  });\n  return null;\n};\n_s4(Plug, \"jTdrpvvRV2PciKlbTVTPGpy8w+I=\", false, function () {\n  return [usePlug];\n});\n_c2 = Plug;\nexport function createPluggable(name) {\n  const pluggable = props => /*#__PURE__*/React.createElement(Pluggable, _objectSpread({\n    name\n  }, props));\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = props => /*#__PURE__*/React.createElement(Plug, _objectSpread({\n    pluggable: pluggableName\n  }, props));\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n\n/**\n * Creates a Pluggable + Plug pair\n */\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\nexport const PluggablesProvider = ({\n  children\n}) => {\n  _s5();\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, {\n      id\n    });\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: sortBy([...(prevState.pluggables[pluggable] || []).filter(e => e.id !== id), renderer], e => e.order || 0)\n      })\n    }));\n  };\n  const removePlug = (pluggable, name) => {\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: sortBy((prevState.pluggables[pluggable] || []).filter(e => e.id !== name), e => e.order || 0)\n      })\n    }));\n  };\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug\n  };\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: pluggables\n  }, children);\n};\n_s5(PluggablesProvider, \"rlCtAOL3/TU4ayP9vWc4PInUxMc=\");\n_c3 = PluggablesProvider;\nexport default Pluggable;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Pluggable\");\n$RefreshReg$(_c2, \"Plug\");\n$RefreshReg$(_c3, \"PluggablesProvider\");","map":{"version":3,"names":["React","sortBy","context","createContext","usePluggable","name","_s","ctx","useContext","Error","pluggables","Pluggable","props","_s2","maxCount","reversed","children","params","undefined","slice","reverse","useMemo","createElement","Fragment","map","R","i","_objectSpread","key","toString","_c","usePlug","pluggable","id","renderer","dependencies","options","_s3","pluggableContext","setPlug","removePlug","order","extra","Object","assign","pluggableName","useEffect","Plug","_ref","_s4","_objectWithoutProperties","_excluded","_c2","createPluggable","createPlugComponent","plugComponent","displayName","createPluggableAndPlug","boundPluggable","PluggablesProvider","_s5","setPluggables","prevState","filter","e","initialPluggables","useState","Provider","value","_c3","$RefreshReg$"],"sources":["/Users/varshanmaji/Projects/volto/packages/volto/src/components/manage/Pluggable/index.js"],"sourcesContent":["// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\n\nimport React from 'react';\nimport sortBy from 'lodash/sortBy';\n\nexport const context = React.createContext();\n\nexport function usePluggable(name) {\n  const ctx = React.useContext(context);\n\n  if (!ctx) {\n    throw new Error(\n      'Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>',\n    );\n  }\n\n  return ctx.pluggables[name] || [];\n}\n\n/**\n\n**/\nexport function Pluggable(props) {\n  const { name, maxCount, reversed, children, params } = props; // , ...rest\n  let pluggables = usePluggable(name);\n\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n\n  if (params && children) {\n    throw Error(\n      'Cannot specify render function and params props at the same time',\n    );\n  }\n\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n\n    return React.createElement(\n      React.Fragment,\n      {},\n      pluggables.map((R, i) =>\n        React.createElement(R, { key: i.toString(), ...params }),\n      ),\n    );\n  }, [params, pluggables, children]);\n}\n\nexport function usePlug({ pluggable, id, renderer, dependencies, options }) {\n  const pluggableContext = React.useContext(context);\n  if (!pluggableContext) {\n    throw new Error(\n      'Using <Plug> component or usePlug hook outside of <PluggablesProvider>',\n    );\n  }\n  const { setPlug, removePlug } = pluggableContext;\n  const { name, order, extra } = options;\n\n  // Could be that a Plug is empty (or it evaluates and have no children)\n  if (renderer) {\n    Object.assign(renderer, { pluggableName: name, extra, order });\n  }\n\n  React.useEffect(\n    () => {\n      if (renderer) {\n        setPlug(pluggable, id, renderer);\n        return () => removePlug(pluggable, id);\n      }\n    },\n    dependencies, // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\n\nexport const Plug = ({\n  pluggable,\n  id,\n  dependencies = [],\n  children,\n  ...options\n}) => {\n  const renderer =\n    children && (typeof children === 'function' ? children : () => children);\n  usePlug({ pluggable, id, renderer, dependencies, options });\n  return null;\n};\n\nexport function createPluggable(name) {\n  const pluggable = (props) =>\n    React.createElement(Pluggable, { name, ...props });\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\n\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = (props) =>\n    React.createElement(Plug, { pluggable: pluggableName, ...props });\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n\n/**\n * Creates a Pluggable + Plug pair\n */\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\n\nexport const PluggablesProvider = ({ children }) => {\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, { id });\n\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          [\n            ...(prevState.pluggables[pluggable] || []).filter(\n              (e) => e.id !== id,\n            ),\n            renderer,\n          ],\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const removePlug = (pluggable, name) => {\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          (prevState.pluggables[pluggable] || []).filter((e) => e.id !== name),\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug,\n  };\n\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return React.createElement(context.Provider, { value: pluggables }, children);\n};\n\nexport default Pluggable;\n"],"mappings":";;;;;;;;AAAA;AACA;;AAEA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,eAAe;AAElC,OAAO,MAAMC,OAAO,gBAAGF,KAAK,CAACG,aAAa,CAAC,CAAC;AAE5C,OAAO,SAASC,YAAYA,CAACC,IAAI,EAAE;EAAAC,EAAA;EACjC,MAAMC,GAAG,GAAGP,KAAK,CAACQ,UAAU,CAACN,OAAO,CAAC;EAErC,IAAI,CAACK,GAAG,EAAE;IACR,MAAM,IAAIE,KAAK,CACb,kFACF,CAAC;EACH;EAEA,OAAOF,GAAG,CAACG,UAAU,CAACL,IAAI,CAAC,IAAI,EAAE;AACnC;;AAEA;AACA;AACA;AAFAC,EAAA,CAZgBF,YAAY;AAe5B,OAAO,SAASO,SAASA,CAACC,KAAK,EAAE;EAAAC,GAAA;EAC/B,MAAM;IAAER,IAAI;IAAES,QAAQ;IAAEC,QAAQ;IAAEC,QAAQ;IAAEC;EAAO,CAAC,GAAGL,KAAK,CAAC,CAAC;EAC9D,IAAIF,UAAU,GAAGN,YAAY,CAACC,IAAI,CAAC;EAEnC,IAAIS,QAAQ,KAAKI,SAAS,EAAE;IAC1BR,UAAU,GAAGA,UAAU,CAACS,KAAK,CAAC,CAAC,EAAEL,QAAQ,CAAC;EAC5C;EACA,IAAIC,QAAQ,KAAKG,SAAS,EAAE;IAC1BR,UAAU,GAAG,CAAC,GAAGA,UAAU,CAAC,CAACU,OAAO,CAAC,CAAC;EACxC;EAEA,IAAIH,MAAM,IAAID,QAAQ,EAAE;IACtB,MAAMP,KAAK,CACT,kEACF,CAAC;EACH;EAEA,OAAOT,KAAK,CAACqB,OAAO,CAAC,MAAM;IACzB,IAAIL,QAAQ,EAAE;MACZ,OAAOA,QAAQ,CAACN,UAAU,CAAC;IAC7B;IAEA,oBAAOV,KAAK,CAACsB,aAAa,CACxBtB,KAAK,CAACuB,QAAQ,EACd,CAAC,CAAC,EACFb,UAAU,CAACc,GAAG,CAAC,CAACC,CAAC,EAAEC,CAAC,kBAClB1B,KAAK,CAACsB,aAAa,CAACG,CAAC,EAAAE,aAAA;MAAIC,GAAG,EAAEF,CAAC,CAACG,QAAQ,CAAC;IAAC,GAAKZ,MAAM,CAAE,CACzD,CACF,CAAC;EACH,CAAC,EAAE,CAACA,MAAM,EAAEP,UAAU,EAAEM,QAAQ,CAAC,CAAC;AACpC;AAACH,GAAA,CA9BeF,SAAS;EAAA,QAENP,YAAY;AAAA;AAAA0B,EAAA,GAFfnB,SAAS;AAgCzB,OAAO,SAASoB,OAAOA,CAAC;EAAEC,SAAS;EAAEC,EAAE;EAAEC,QAAQ;EAAEC,YAAY;EAAEC;AAAQ,CAAC,EAAE;EAAAC,GAAA;EAC1E,MAAMC,gBAAgB,GAAGtC,KAAK,CAACQ,UAAU,CAACN,OAAO,CAAC;EAClD,IAAI,CAACoC,gBAAgB,EAAE;IACrB,MAAM,IAAI7B,KAAK,CACb,wEACF,CAAC;EACH;EACA,MAAM;IAAE8B,OAAO;IAAEC;EAAW,CAAC,GAAGF,gBAAgB;EAChD,MAAM;IAAEjC,IAAI;IAAEoC,KAAK;IAAEC;EAAM,CAAC,GAAGN,OAAO;;EAEtC;EACA,IAAIF,QAAQ,EAAE;IACZS,MAAM,CAACC,MAAM,CAACV,QAAQ,EAAE;MAAEW,aAAa,EAAExC,IAAI;MAAEqC,KAAK;MAAED;IAAM,CAAC,CAAC;EAChE;EAEAzC,KAAK,CAAC8C,SAAS,CACb,MAAM;IACJ,IAAIZ,QAAQ,EAAE;MACZK,OAAO,CAACP,SAAS,EAAEC,EAAE,EAAEC,QAAQ,CAAC;MAChC,OAAO,MAAMM,UAAU,CAACR,SAAS,EAAEC,EAAE,CAAC;IACxC;EACF,CAAC,EACDE,YAAY,CAAE;EAChB,CAAC;AACH;AAACE,GAAA,CAxBeN,OAAO;AA0BvB,OAAO,MAAMgB,IAAI,GAAGC,IAAA,IAMd;EAAAC,GAAA;EAAA,IANe;MACnBjB,SAAS;MACTC,EAAE;MACFE,YAAY,GAAG,EAAE;MACjBnB;IAEF,CAAC,GAAAgC,IAAA;IADIZ,OAAO,GAAAc,wBAAA,CAAAF,IAAA,EAAAG,SAAA;EAEV,MAAMjB,QAAQ,GACZlB,QAAQ,KAAK,OAAOA,QAAQ,KAAK,UAAU,GAAGA,QAAQ,GAAG,MAAMA,QAAQ,CAAC;EAC1Ee,OAAO,CAAC;IAAEC,SAAS;IAAEC,EAAE;IAAEC,QAAQ;IAAEC,YAAY;IAAEC;EAAQ,CAAC,CAAC;EAC3D,OAAO,IAAI;AACb,CAAC;AAACa,GAAA,CAXWF,IAAI;EAAA,QASfhB,OAAO;AAAA;AAAAqB,GAAA,GATIL,IAAI;AAajB,OAAO,SAASM,eAAeA,CAAChD,IAAI,EAAE;EACpC,MAAM2B,SAAS,GAAIpB,KAAK,iBACtBZ,KAAK,CAACsB,aAAa,CAACX,SAAS,EAAAgB,aAAA;IAAItB;EAAI,GAAKO,KAAK,CAAE,CAAC;EACpDoB,SAAS,CAACa,aAAa,GAAGxC,IAAI;EAC9B2B,SAAS,CAACe,IAAI,GAAGO,mBAAmB,CAACjD,IAAI,CAAC;EAC1C,OAAO2B,SAAS;AAClB;AAEA,SAASsB,mBAAmBA,CAACT,aAAa,EAAE;EAC1C,MAAMU,aAAa,GAAI3C,KAAK,iBAC1BZ,KAAK,CAACsB,aAAa,CAACyB,IAAI,EAAApB,aAAA;IAAIK,SAAS,EAAEa;EAAa,GAAKjC,KAAK,CAAE,CAAC;EACnE2C,aAAa,CAACC,WAAW,GAAG,cAAcX,aAAa,GAAG;EAC1D,OAAOU,aAAa;AACtB;;AAEA;AACA;AACA;AACA,OAAO,SAASE,sBAAsBA,CAACpD,IAAI,EAAE;EAC3C,MAAMqD,cAAc,GAAGL,eAAe,CAAChD,IAAI,CAAC;EAC5C,OAAO,CAACqD,cAAc,EAAEA,cAAc,CAACX,IAAI,CAAC;AAC9C;AAEA,OAAO,MAAMY,kBAAkB,GAAGA,CAAC;EAAE3C;AAAS,CAAC,KAAK;EAAA4C,GAAA;EAClD,MAAMrB,OAAO,GAAGA,CAACP,SAAS,EAAEC,EAAE,EAAEC,QAAQ,KAAK;IAC3CS,MAAM,CAACC,MAAM,CAACV,QAAQ,EAAE;MAAED;IAAG,CAAC,CAAC;IAE/B4B,aAAa,CAAEC,SAAS,IAAAnC,aAAA,CAAAA,aAAA,KACnBmC,SAAS;MACZpD,UAAU,EAAAiB,aAAA,CAAAA,aAAA,KACLmC,SAAS,CAACpD,UAAU;QACvB,CAACsB,SAAS,GAAG/B,MAAM,CACjB,CACE,GAAG,CAAC6D,SAAS,CAACpD,UAAU,CAACsB,SAAS,CAAC,IAAI,EAAE,EAAE+B,MAAM,CAC9CC,CAAC,IAAKA,CAAC,CAAC/B,EAAE,KAAKA,EAClB,CAAC,EACDC,QAAQ,CACT,EACA8B,CAAC,IAAKA,CAAC,CAACvB,KAAK,IAAI,CACpB;MAAC;IACF,EACD,CAAC;EACL,CAAC;EAED,MAAMD,UAAU,GAAGA,CAACR,SAAS,EAAE3B,IAAI,KAAK;IACtCwD,aAAa,CAAEC,SAAS,IAAAnC,aAAA,CAAAA,aAAA,KACnBmC,SAAS;MACZpD,UAAU,EAAAiB,aAAA,CAAAA,aAAA,KACLmC,SAAS,CAACpD,UAAU;QACvB,CAACsB,SAAS,GAAG/B,MAAM,CACjB,CAAC6D,SAAS,CAACpD,UAAU,CAACsB,SAAS,CAAC,IAAI,EAAE,EAAE+B,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAAC/B,EAAE,KAAK5B,IAAI,CAAC,EACnE2D,CAAC,IAAKA,CAAC,CAACvB,KAAK,IAAI,CACpB;MAAC;IACF,EACD,CAAC;EACL,CAAC;EAED,MAAMwB,iBAAiB,GAAG;IACxBvD,UAAU,EAAE,CAAC,CAAC;IACd6B,OAAO;IACPC;EACF,CAAC;EAED,MAAM,CAAC9B,UAAU,EAAEmD,aAAa,CAAC,GAAG7D,KAAK,CAACkE,QAAQ,CAACD,iBAAiB,CAAC;EACrE,oBAAOjE,KAAK,CAACsB,aAAa,CAACpB,OAAO,CAACiE,QAAQ,EAAE;IAAEC,KAAK,EAAE1D;EAAW,CAAC,EAAEM,QAAQ,CAAC;AAC/E,CAAC;AAAC4C,GAAA,CA1CWD,kBAAkB;AAAAU,GAAA,GAAlBV,kBAAkB;AA4C/B,eAAehD,SAAS;AAAC,IAAAmB,EAAA,EAAAsB,GAAA,EAAAiB,GAAA;AAAAC,YAAA,CAAAxC,EAAA;AAAAwC,YAAA,CAAAlB,GAAA;AAAAkB,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}